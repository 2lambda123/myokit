name: Ubuntu unit tests
on:
  push:
    branches:
      - main
  pull_request:
    types: [opened, synchronize, reopened, ready_for_review]
    branches:
      - '**'

jobs:

  build-and-test:
    name: unit-ubuntu
    runs-on: ubuntu-latest

    steps:
      - name: Add intel repo
        run: |
          sudo wget -O- https://apt.repos.intel.com/intel-gpg-keys/GPG-PUB-KEY-INTEL-SW-PRODUCTS.PUB | gpg --dearmor | tee /usr/share/keyrings/oneapi-archive-keyring.gpg > /dev/null;
          sudo echo "deb [signed-by=/usr/share/keyrings/oneapi-archive-keyring.gpg] https://apt.repos.intel.com/oneapi all main" | sudo tee /etc/apt/sources.list.d/oneAPI.list;
          sudo apt-get -qq update;
      - name: Install Intel oneapi libs
        uses: awalsh128/cache-apt-pkgs-action@latest
        with:
          packages: intel-oneapi-runtime-libs
          version: 1
          debug: true

